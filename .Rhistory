dt_emendas <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda)
]
# Ver quantos municípios foram favorecidos por algum empenho de emenda em 2021
length(dt_emendas[, unique(id_municipio)])
# Ver quais tipos de emendas há na base
dt_emendas[, unique(tipo_emenda)]
# Simplificar nome do tipo de emenda
dt_emendas[, tipo_emenda := fcase(
tipo_emenda == "INDIVIDUAL", "individual",
tipo_emenda == "BANCADA ESTADUAL (RP 7)", "bancada",
tipo_emenda == "RELATOR (RP 9)", "relator"
)]
# Dar uma olhada na base
head(dt_emendas)
# Resumir valor empenhado de emendas por tipo
dt_emendas[, .(valor_empenhado_ipca = sum(valor_empenhado_ipca)), by = tipo_emenda]
# Resumir qtde de municípios que receberam cada tipo de emenda
writeLines(paste0(
"Quantidade de municípios a receberem qualquer tipo de emenda: ", length(dt_emendas[, unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas individuais: ", length(dt_emendas[tipo_emenda == "individual", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de bancada: ", length(dt_emendas[tipo_emenda == "bancada", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de relator: ", length(dt_emendas[tipo_emenda == "relator", unique(id_municipio)])
))
rm(list = ls())
library(readxl) # para obtenção dos dados
library(basedosdados) # para obtenção dos dados
library(dplyr) # para transformação dos dados
library(data.table) # para transformação dos dados
library(janitor) # para transformação dos dados
library(ggplot2) # para visualização dos dados
library(cowplot) # para visualização dos dados (plotá-los lado a lado)
library(scales) # para visualização dos dados (fazer eixos bonito)
library(estimatr) # para modelagem
library(modelsummary) # para visualização de resultados dos modelos
# Carregar planilha montada a partir dos relatórios do IBGE Cidades
dt_municipios <- read_excel("Bases de dados/Brasil/IBGE_municipios.xlsx")
setDT(dt_municipios)
# Renomear colunas
nomes <- c("id_municipio_nome", "sigla_uf", "mortalidade_infantil", "PIBpc", "taxa_escolarizacao", "pop", "densidade_demografica")
colnames(dt_municipios) <- nomes
rm(nomes)
# Transformar gentílico na sigla do UF
dt_municipios[, sigla_uf := fcase(
sigla_uf == "acriano", "AC",
sigla_uf == "alagoano", "AL",
sigla_uf == "amapaense", "AP",
sigla_uf == "amazonense", "AM",
sigla_uf == "baiano", "BA",
sigla_uf == "cearense", "CE",
sigla_uf == "brasiliense", "DF",
sigla_uf == "capixaba ou espírito-santense", "ES",
sigla_uf == "goiano", "GO",
sigla_uf == "maranhense", "MA",
sigla_uf == "mato-grossense", "MT",
sigla_uf == "sul-mato-grossense ou mato-grossense-do-sul", "MS",
sigla_uf == "mineiro", "MG",
sigla_uf == "paranaense", "PR",
sigla_uf == "paraibano", "PB",
sigla_uf == "paraense", "PA",
sigla_uf == "pernambucano", "PE",
sigla_uf == "piauiense", "PI",
sigla_uf == "potiguar, norte-rio-grandense, rio-grandense-do-norte", "RN",
sigla_uf == "gaúcho ou sul-rio-grandense", "RS",
sigla_uf == "fluminense", "RJ",
sigla_uf == "rondoniense ou rondoniano", "RO",
sigla_uf == "roraimense", "RR",
sigla_uf == "catarinense ou barriga-verde", "SC",
sigla_uf == "sergipano ou sergipense", "SE",
sigla_uf == "paulista", "SP",
sigla_uf == "tocantinense", "TO"
)]
# Criar coluna de região
dt_municipios[, regiao := fcase(
sigla_uf %in% c("AC", "AM", "AP", "PA", "RO", "RR", "TO"), "Norte",
sigla_uf %in% c("AL", "BA", "CE", "MA", "PE", "PB", "PI", "RN", "SE"), "Nordeste",
sigla_uf %in% c("DF", "GO", "MS", "MT"), "Centro-Oeste",
sigla_uf %in% c("ES", "MG", "RJ", "SP"), "Sudeste",
sigla_uf %in% c("PR", "RS", "SC"), "Sul")]
# Transformar colunas em variáveis numéricas
## Inteiros
dt_municipios[, pop := gsub("[^0-9.-]", "", pop) %>% as.numeric()]
## Decimais
dt_municipios[,
densidade_demografica := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", densidade_demografica))
)
]
dt_municipios[,
mortalidade_infantil := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", mortalidade_infantil))
)
]
dt_municipios[,
PIBpc := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", PIBpc))
)
]
dt_municipios[,
taxa_escolarizacao := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", taxa_escolarizacao))
)/100
]
# Dar uma olhada na base
str(dt_municipios)
# # Fazer query
# query <- "
# SELECT
#     dados.id_emenda as id_emenda,
#     dados.ano_emenda as ano_emenda,
#     dados.id_autor_emenda as id_autor_emenda,
#     dados.numero_emenda as numero_emenda,
#     dados.id_municipio_gasto as id_municipio
# FROM `basedosdados.br_cgu_emendas_parlamentares.microdados` AS dados
# WHERE
#     dados.ano_emenda IN (2021)
# "
# de_para_emendas_municipios <- read_sql(query, billing_project_id = "pub-450900")
# setDT(de_para_emendas_municipios)
# rm(query)
#
# # Criar emenda (número/ano) igual à base de emendas do Siga Brasil
# de_para_emendas_municipios[, emenda_numero_ano := paste0(id_autor_emenda,
#                                                          numero_emenda,
#                                                          "-",
#                                                          ano_emenda)]
#
# # Selecionar somente as colunas de de-para
# de_para_emendas_municipios <- de_para_emendas_municipios[, .(emenda_numero_ano, id_municipio)]
#
# # Salvar base de dados resultante
# saveRDS(de_para_emendas_municipios, "Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados que relaciona emendas e municípios (por código do IBGE)
de_para_emendas_municipios <- readRDS("Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados de emendas parlamentares
dt_emendas <- read_excel("Bases de dados/Brasil/SigaBrasil_emendas.xlsx")
setDT(dt_emendas)
# Renomear colunas
colnames(dt_emendas) <- make_clean_names(colnames(dt_emendas))
# Juntar com informação de códigos IBGE
dt_emendas <- merge(dt_emendas, de_para_emendas_municipios, all.x = T)
rm(de_para_emendas_municipios)
# Substituir id_municipio manualmente para as 4 emendas sem essa informação na base
## Campo Grande (MS)
dt_emendas[emenda_numero_ano == "14510004-2021" , id_municipio := "5002704"]
dt_emendas[emenda_numero_ano == "37390008-2021", id_municipio := "2504009"]
dt_emendas[emenda_numero_ano == "40680005-2021", id_municipio := "1301605"]
# Garantir que não há NAs
colSums(is.na(dt_emendas))
# Renomear coluna de tipo
setnames(dt_emendas, "autor_tipo", "tipo_emenda")
# Resumir dados por município, tipo de emenda, função e GND e armazenar dt para eventuais análises de heterogeneidade
dt_emendas_com_funcao_gnd <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda, funcao, gnd_desc)
]
# Resumir dados por município e tipo de emenda
dt_emendas <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda)
]
# Ver quantos municípios foram favorecidos por algum empenho de emenda em 2021
length(dt_emendas[, unique(id_municipio)])
# Ver quais tipos de emendas há na base
dt_emendas[, unique(tipo_emenda)]
# Simplificar nome do tipo de emenda
dt_emendas[, tipo_emenda := fcase(
tipo_emenda == "INDIVIDUAL", "individual",
tipo_emenda == "BANCADA ESTADUAL (RP 7)", "bancada",
tipo_emenda == "RELATOR (RP 9)", "relator"
)]
# Dar uma olhada na base
head(dt_emendas)
# Resumir valor empenhado de emendas por tipo
dt_emendas[, .(valor_empenhado_ipca = sum(valor_empenhado_ipca)), by = tipo_emenda]
# Resumir qtde de municípios que receberam cada tipo de emenda
writeLines(paste0(
"Quantidade de municípios a receberem qualquer tipo de emenda: ", length(dt_emendas[, unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas individuais: ", length(dt_emendas[tipo_emenda == "individual", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de bancada: ", length(dt_emendas[tipo_emenda == "bancada", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de relator: ", length(dt_emendas[tipo_emenda == "relator", unique(id_municipio)])
))
# Ver se algum município de dt_eleicoes não está em dt_municípios
municipios_dt_eleicoes <- unique(dt_eleicoes[, paste0(id_municipio_nome, sigla_uf)])
# Resultados
teste <- modelsummary(list(
"Duas regressões lineares" = regs_lineares,
"Duas regressões não lineares" = regs_flexiveis,
"Duas regressões lineares com controles" = regs_lineares_controles,
"Duas regressões não lineares com controles" = regs_flexiveis_controles
),
statistic = "p.value")
# Duas regressões lineares com controle de razão de votos do PP
regs_lineares <- lm_robust(valor_empenhado_ipca ~ vitoria_pp*votos_razao_pp_centr, data = dt_todas)
library(readxl) # para obtenção dos dados
library(basedosdados) # para obtenção dos dados
library(dplyr) # para transformação dos dados
library(data.table) # para transformação dos dados
library(janitor) # para transformação dos dados
library(ggplot2) # para visualização dos dados
library(cowplot) # para visualização dos dados (plotá-los lado a lado)
library(scales) # para visualização dos dados (fazer eixos bonito)
library(estimatr) # para modelagem
library(modelsummary) # para visualização de resultados dos modelos
# Carregar planilha montada a partir dos relatórios do IBGE Cidades
dt_municipios <- read_excel("Bases de dados/Brasil/IBGE_municipios.xlsx")
setDT(dt_municipios)
# Renomear colunas
nomes <- c("id_municipio_nome", "sigla_uf", "mortalidade_infantil", "PIBpc", "taxa_escolarizacao", "pop", "densidade_demografica")
colnames(dt_municipios) <- nomes
rm(nomes)
# Transformar gentílico na sigla do UF
dt_municipios[, sigla_uf := fcase(
sigla_uf == "acriano", "AC",
sigla_uf == "alagoano", "AL",
sigla_uf == "amapaense", "AP",
sigla_uf == "amazonense", "AM",
sigla_uf == "baiano", "BA",
sigla_uf == "cearense", "CE",
sigla_uf == "brasiliense", "DF",
sigla_uf == "capixaba ou espírito-santense", "ES",
sigla_uf == "goiano", "GO",
sigla_uf == "maranhense", "MA",
sigla_uf == "mato-grossense", "MT",
sigla_uf == "sul-mato-grossense ou mato-grossense-do-sul", "MS",
sigla_uf == "mineiro", "MG",
sigla_uf == "paranaense", "PR",
sigla_uf == "paraibano", "PB",
sigla_uf == "paraense", "PA",
sigla_uf == "pernambucano", "PE",
sigla_uf == "piauiense", "PI",
sigla_uf == "potiguar, norte-rio-grandense, rio-grandense-do-norte", "RN",
sigla_uf == "gaúcho ou sul-rio-grandense", "RS",
sigla_uf == "fluminense", "RJ",
sigla_uf == "rondoniense ou rondoniano", "RO",
sigla_uf == "roraimense", "RR",
sigla_uf == "catarinense ou barriga-verde", "SC",
sigla_uf == "sergipano ou sergipense", "SE",
sigla_uf == "paulista", "SP",
sigla_uf == "tocantinense", "TO"
)]
# Criar coluna de região
dt_municipios[, regiao := fcase(
sigla_uf %in% c("AC", "AM", "AP", "PA", "RO", "RR", "TO"), "Norte",
sigla_uf %in% c("AL", "BA", "CE", "MA", "PE", "PB", "PI", "RN", "SE"), "Nordeste",
sigla_uf %in% c("DF", "GO", "MS", "MT"), "Centro-Oeste",
sigla_uf %in% c("ES", "MG", "RJ", "SP"), "Sudeste",
sigla_uf %in% c("PR", "RS", "SC"), "Sul")]
# Transformar colunas em variáveis numéricas
## Inteiros
dt_municipios[, pop := gsub("[^0-9.-]", "", pop) %>% as.numeric()]
## Decimais
dt_municipios[,
densidade_demografica := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", densidade_demografica))
)
]
dt_municipios[,
mortalidade_infantil := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", mortalidade_infantil))
)
]
dt_municipios[,
PIBpc := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", PIBpc))
)
]
dt_municipios[,
taxa_escolarizacao := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", taxa_escolarizacao))
)/100
]
# Dar uma olhada na base
str(dt_municipios)
# # Fazer query
# query <- "
# SELECT
#     dados.id_emenda as id_emenda,
#     dados.ano_emenda as ano_emenda,
#     dados.id_autor_emenda as id_autor_emenda,
#     dados.numero_emenda as numero_emenda,
#     dados.id_municipio_gasto as id_municipio
# FROM `basedosdados.br_cgu_emendas_parlamentares.microdados` AS dados
# WHERE
#     dados.ano_emenda IN (2021)
# "
# de_para_emendas_municipios <- read_sql(query, billing_project_id = "pub-450900")
# setDT(de_para_emendas_municipios)
# rm(query)
#
# # Criar emenda (número/ano) igual à base de emendas do Siga Brasil
# de_para_emendas_municipios[, emenda_numero_ano := paste0(id_autor_emenda,
#                                                          numero_emenda,
#                                                          "-",
#                                                          ano_emenda)]
#
# # Selecionar somente as colunas de de-para
# de_para_emendas_municipios <- de_para_emendas_municipios[, .(emenda_numero_ano, id_municipio)]
#
# # Salvar base de dados resultante
# saveRDS(de_para_emendas_municipios, "Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados que relaciona emendas e municípios (por código do IBGE)
de_para_emendas_municipios <- readRDS("Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados de emendas parlamentares
dt_emendas <- read_excel("Bases de dados/Brasil/SigaBrasil_emendas.xlsx")
setDT(dt_emendas)
# Renomear colunas
colnames(dt_emendas) <- make_clean_names(colnames(dt_emendas))
# Juntar com informação de códigos IBGE
dt_emendas <- merge(dt_emendas, de_para_emendas_municipios, all.x = T)
rm(de_para_emendas_municipios)
# Substituir id_municipio manualmente para as 4 emendas sem essa informação na base
## Campo Grande (MS)
dt_emendas[emenda_numero_ano == "14510004-2021" , id_municipio := "5002704"]
dt_emendas[emenda_numero_ano == "37390008-2021", id_municipio := "2504009"]
dt_emendas[emenda_numero_ano == "40680005-2021", id_municipio := "1301605"]
# Garantir que não há NAs
colSums(is.na(dt_emendas))
# Renomear coluna de tipo
setnames(dt_emendas, "autor_tipo", "tipo_emenda")
# Resumir dados por município, tipo de emenda, função e GND e armazenar dt para eventuais análises de heterogeneidade
dt_emendas_com_funcao_gnd <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda, funcao, gnd_desc)
]
# Resumir dados por município e tipo de emenda
dt_emendas <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda)
]
# Ver quantos municípios foram favorecidos por algum empenho de emenda em 2021
length(dt_emendas[, unique(id_municipio)])
# Ver quais tipos de emendas há na base
dt_emendas[, unique(tipo_emenda)]
# Simplificar nome do tipo de emenda
dt_emendas[, tipo_emenda := fcase(
tipo_emenda == "INDIVIDUAL", "individual",
tipo_emenda == "BANCADA ESTADUAL (RP 7)", "bancada",
tipo_emenda == "RELATOR (RP 9)", "relator"
)]
# Dar uma olhada na base
head(dt_emendas)
# Resumir valor empenhado de emendas por tipo
dt_emendas[, .(valor_empenhado_ipca = sum(valor_empenhado_ipca)), by = tipo_emenda]
# Resumir qtde de municípios que receberam cada tipo de emenda
writeLines(paste0(
"Quantidade de municípios a receberem qualquer tipo de emenda: ", length(dt_emendas[, unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas individuais: ", length(dt_emendas[tipo_emenda == "individual", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de bancada: ", length(dt_emendas[tipo_emenda == "bancada", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de relator: ", length(dt_emendas[tipo_emenda == "relator", unique(id_municipio)])
))
# Ver se algum município de dt_eleicoes não está em dt_municípios
municipios_dt_eleicoes <- unique(dt_eleicoes[, paste0(id_municipio_nome, sigla_uf)])
dt_eleicoes
library(readxl) # para obtenção dos dados
library(basedosdados) # para obtenção dos dados
library(dplyr) # para transformação dos dados
library(data.table) # para transformação dos dados
library(janitor) # para transformação dos dados
library(ggplot2) # para visualização dos dados
library(cowplot) # para visualização dos dados (plotá-los lado a lado)
library(scales) # para visualização dos dados (fazer eixos bonito)
library(estimatr) # para modelagem
library(modelsummary) # para visualização de resultados dos modelos
# Carregar planilha montada a partir dos relatórios do IBGE Cidades
dt_municipios <- read_excel("Bases de dados/Brasil/IBGE_municipios.xlsx")
setDT(dt_municipios)
# Renomear colunas
nomes <- c("id_municipio_nome", "sigla_uf", "mortalidade_infantil", "PIBpc", "taxa_escolarizacao", "pop", "densidade_demografica")
colnames(dt_municipios) <- nomes
rm(nomes)
# Transformar gentílico na sigla do UF
dt_municipios[, sigla_uf := fcase(
sigla_uf == "acriano", "AC",
sigla_uf == "alagoano", "AL",
sigla_uf == "amapaense", "AP",
sigla_uf == "amazonense", "AM",
sigla_uf == "baiano", "BA",
sigla_uf == "cearense", "CE",
sigla_uf == "brasiliense", "DF",
sigla_uf == "capixaba ou espírito-santense", "ES",
sigla_uf == "goiano", "GO",
sigla_uf == "maranhense", "MA",
sigla_uf == "mato-grossense", "MT",
sigla_uf == "sul-mato-grossense ou mato-grossense-do-sul", "MS",
sigla_uf == "mineiro", "MG",
sigla_uf == "paranaense", "PR",
sigla_uf == "paraibano", "PB",
sigla_uf == "paraense", "PA",
sigla_uf == "pernambucano", "PE",
sigla_uf == "piauiense", "PI",
sigla_uf == "potiguar, norte-rio-grandense, rio-grandense-do-norte", "RN",
sigla_uf == "gaúcho ou sul-rio-grandense", "RS",
sigla_uf == "fluminense", "RJ",
sigla_uf == "rondoniense ou rondoniano", "RO",
sigla_uf == "roraimense", "RR",
sigla_uf == "catarinense ou barriga-verde", "SC",
sigla_uf == "sergipano ou sergipense", "SE",
sigla_uf == "paulista", "SP",
sigla_uf == "tocantinense", "TO"
)]
# Criar coluna de região
dt_municipios[, regiao := fcase(
sigla_uf %in% c("AC", "AM", "AP", "PA", "RO", "RR", "TO"), "Norte",
sigla_uf %in% c("AL", "BA", "CE", "MA", "PE", "PB", "PI", "RN", "SE"), "Nordeste",
sigla_uf %in% c("DF", "GO", "MS", "MT"), "Centro-Oeste",
sigla_uf %in% c("ES", "MG", "RJ", "SP"), "Sudeste",
sigla_uf %in% c("PR", "RS", "SC"), "Sul")]
# Transformar colunas em variáveis numéricas
## Inteiros
dt_municipios[, pop := gsub("[^0-9.-]", "", pop) %>% as.numeric()]
## Decimais
dt_municipios[,
densidade_demografica := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", densidade_demografica))
)
]
dt_municipios[,
mortalidade_infantil := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", mortalidade_infantil))
)
]
dt_municipios[,
PIBpc := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", PIBpc))
)
]
dt_municipios[,
taxa_escolarizacao := as.numeric(
gsub(",", ".", gsub("[^0-9,]", "", taxa_escolarizacao))
)/100
]
# Dar uma olhada na base
str(dt_municipios)
# # Fazer query
# query <- "
# SELECT
#     dados.id_emenda as id_emenda,
#     dados.ano_emenda as ano_emenda,
#     dados.id_autor_emenda as id_autor_emenda,
#     dados.numero_emenda as numero_emenda,
#     dados.id_municipio_gasto as id_municipio
# FROM `basedosdados.br_cgu_emendas_parlamentares.microdados` AS dados
# WHERE
#     dados.ano_emenda IN (2021)
# "
# de_para_emendas_municipios <- read_sql(query, billing_project_id = "pub-450900")
# setDT(de_para_emendas_municipios)
# rm(query)
#
# # Criar emenda (número/ano) igual à base de emendas do Siga Brasil
# de_para_emendas_municipios[, emenda_numero_ano := paste0(id_autor_emenda,
#                                                          numero_emenda,
#                                                          "-",
#                                                          ano_emenda)]
#
# # Selecionar somente as colunas de de-para
# de_para_emendas_municipios <- de_para_emendas_municipios[, .(emenda_numero_ano, id_municipio)]
#
# # Salvar base de dados resultante
# saveRDS(de_para_emendas_municipios, "Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados que relaciona emendas e municípios (por código do IBGE)
de_para_emendas_municipios <- readRDS("Bases de dados/Brasil/BD_id_emenda_municipio.rds")
# Carregar base de dados de emendas parlamentares
dt_emendas <- read_excel("Bases de dados/Brasil/SigaBrasil_emendas.xlsx")
setDT(dt_emendas)
# Renomear colunas
colnames(dt_emendas) <- make_clean_names(colnames(dt_emendas))
# Juntar com informação de códigos IBGE
dt_emendas <- merge(dt_emendas, de_para_emendas_municipios, all.x = T)
rm(de_para_emendas_municipios)
# Substituir id_municipio manualmente para as 4 emendas sem essa informação na base
## Campo Grande (MS)
dt_emendas[emenda_numero_ano == "14510004-2021" , id_municipio := "5002704"]
dt_emendas[emenda_numero_ano == "37390008-2021", id_municipio := "2504009"]
dt_emendas[emenda_numero_ano == "40680005-2021", id_municipio := "1301605"]
# Garantir que não há NAs
colSums(is.na(dt_emendas))
# Renomear coluna de tipo
setnames(dt_emendas, "autor_tipo", "tipo_emenda")
# Resumir dados por município, tipo de emenda, função e GND e armazenar dt para eventuais análises de heterogeneidade
dt_emendas_com_funcao_gnd <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda, funcao, gnd_desc)
]
# Resumir dados por município e tipo de emenda
dt_emendas <- dt_emendas[,
.(valor_empenhado_ipca = sum(empenhado_ipca)),
by = .(id_municipio, tipo_emenda)
]
# Ver quantos municípios foram favorecidos por algum empenho de emenda em 2021
length(dt_emendas[, unique(id_municipio)])
# Ver quais tipos de emendas há na base
dt_emendas[, unique(tipo_emenda)]
# Simplificar nome do tipo de emenda
dt_emendas[, tipo_emenda := fcase(
tipo_emenda == "INDIVIDUAL", "individual",
tipo_emenda == "BANCADA ESTADUAL (RP 7)", "bancada",
tipo_emenda == "RELATOR (RP 9)", "relator"
)]
# Dar uma olhada na base
head(dt_emendas)
# Resumir valor empenhado de emendas por tipo
dt_emendas[, .(valor_empenhado_ipca = sum(valor_empenhado_ipca)), by = tipo_emenda]
# Resumir qtde de municípios que receberam cada tipo de emenda
writeLines(paste0(
"Quantidade de municípios a receberem qualquer tipo de emenda: ", length(dt_emendas[, unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas individuais: ", length(dt_emendas[tipo_emenda == "individual", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de bancada: ", length(dt_emendas[tipo_emenda == "bancada", unique(id_municipio)]),
"\nQuantidade de municípios a receberem emendas de relator: ", length(dt_emendas[tipo_emenda == "relator", unique(id_municipio)])
))
